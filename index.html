<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Laporan Jaga IGD</title>
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
    <meta http-equiv="Pragma" content="no-cache" />
    <meta http-equiv="Expires" content="0" />
      <!-- MENGHUBUNGKAN FONT BARU DARI GOOGLE FONTS -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Google+Sans:ital,opsz,wght@0,17..18,400..700;1,17..18,400..700&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
      /* ============================
         BASE STYLES (LIGHT MODE)
      ============================ */
      body {
          font-family: 'Google Sans', sans-serif;
          background-color: #f4f7f9;
      }
      .shift-header {
          color: white;
          padding: 14px 18px;
          border-radius: 0.75rem;
          margin-top: 16px;
          font-weight: 800;
          font-size: 1rem;
          display: flex;
          align-items: center;
          justify-content: flex-start;
          gap: 10px;
          box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
          transition: all 0.5s;
      }
      .shift-header:hover { opacity: 0.95; transform: translateY(-1px); }
      
      .input-group label {
          font-weight: 600;
          color: #374151;
          display: block;
          margin-bottom: 4px;
      }
      .input-group input, .input-group textarea, .input-group select {
          padding: 10px;
          border: 2px solid #e5e7eb;
          border-radius: 0.75rem;
          transition: all 0.2s;
          background-color: white;
          width: 100%;
      }
      .input-group input:focus, .input-group textarea:focus, .input-group select:focus {
          border-color: #0ea5e9;
          box-shadow: 0 0 0 4px rgba(14, 165, 233, 0.3);
          outline: none;
      }
      .input-row {
          display: grid;
          grid-template-columns: repeat(2, 1fr);
          gap: 12px;
      }
      .doctor-inputs {
          display: flex;
          gap: 8px;
          align-items: center;
      }
      .doctor-inputs select,
      .doctor-inputs input {
          flex-grow: 1;
          flex-basis: 0;
          min-width: 0;
      }
      .doctor-inputs input {
           text-align: center;
      }
      .input-group input, .input-group select, .input-group textarea {
          width: 100%;
      }

      /* STYLE BARU UNTUK WARNING MESSAGE */
      #doctorWarningMessage {
          display: flex;
          flex-direction: column;
          gap: 8px;
          border-left-width: 6px;
          animation: pulse-red 2s infinite;
      }
      @keyframes pulse-red {
          0% { border-left-color: #ef4444; }
          50% { border-left-color: #fca5a5; }
          100% { border-left-color: #ef4444; }
      }

      /* ============================
           DARK MODE SOFT STYLES
      ============================ */
      .dark {
          background-color: #1e293b !important;
          color: #e2e8f0 !important;
      }
      .dark body {
          background-color: #1e293b !important;
      }
      .dark .max-w-2xl {
          background-color: #334155 !important;
          color: #e2e8f0 !important;
      }
      .dark input,
      .dark textarea,
      .dark select {
          background-color: #475569 !important;
          border-color: #64748b !important;
          color: #f1f5f9 !important;
      }
      .dark .bg-white {
          background-color: #3b4758 !important;
      }
      .dark .bg-gray-100 {
          background-color: #475569 !important;
      }
      .dark .text-gray-800 {
          color: #f1f5f9 !important;
      }
      .dark .text-gray-600,
      .dark .text-gray-500 {
          color: #cbd5e1 !important;
      }
      .dark .border {
          border-color: #475569 !important;
      }
      .dark .bg-slate-50, .dark .bg-indigo-50, .dark .bg-amber-50, .dark .bg-fuchsia-50 {
          background-color: #334155 !important;
      }
      .dark .text-sky-600 { color: #60a5fa !important; }
      .dark .text-sky-700 { color: #93c5fd !important; }
      .dark .text-gray-700 { color: #cbd5e1 !important; }
      .dark .text-sm, .dark .text-base, .dark .font-medium, .dark .font-semibold {
          color: #f1f5f9 !important;
      }
      .dark .input-group label {
          color: #e2e8f0 !important;
      }
      .dark .bg-red-100 { background-color: #450a0a !important; }
      .dark .border-red-400 { border-color: #991b1b !important; }
      .dark .text-red-700 { color: #fecaca !important; }

      .dark .app-logo {
          filter: drop-shadow(0 0 2px rgba(255,255,255,0.2));
      }
    </style>
  </head>
  <body class="p-4 md:p-8">
    <!-- Kontainer Utama Tombol (Fixed di pojok kanan atas) -->
    <div class="fixed top-4 right-4 flex items-center gap-1 z-50">
        
        <!-- Tombol Refresh -->
        <button
            id="refreshBtn"
            class="bg-blue-500 text-white p-2 rounded-xl shadow-lg hover:bg-blue-500 transition flex items-center justify-center h-10 px-3 md:px-4"
            title="Muat Ulang Halaman">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" />
            </svg>
            <span class="hidden md:inline ml-2 text-sm font-medium">Segarkan</span>
        </button>

        <!-- Tombol Dark Mode -->
        <button
            id="darkToggle"
            class="
                bg-white text-gray-800 border border-gray-50
                hover:bg-gray-100 
                dark:bg-gray-100 dark:text-gray dark:border-gray-400
                dark:hover:bg-gray-100
                h-10 px-4 rounded-xl shadow-md hover:shadow-lg transition-all 
                flex items-center justify-center text-sm font-medium">
            <span id="icon">üåì</span>
            <span class="hidden md:inline ml-2">Gelap/Terang</span>
        </button>
    </div>

    <div class="max-w-2xl mx-auto bg-white p-6 md:p-8 rounded-2xl shadow-2xl">
      <div class="space-y-4 mb-6 border-b pb4">
        <div class="flex items-center gap-4 mb-2">
          <img
            src="LOGO IGD.png"
            alt="Logo IGD"
            class="app-logo w-14 h-14 md:w-20 md:h-20 object-contain border-none"/>
          <div>
            <h1 class="text-2xl md:text-3xl font-extrabold text-gray-800 leading-tight">Laporan Jaga IGD</h1>
            <p class="text-gray-500 text-sm font-medium">RS Dian Husada Versi 2.6.2</p>
          </div>
        </div>
      </div>

      <div class="bg-gradient-to-r from-indigo-500 to-purple-600 p-4 rounded-xl mb-6 text-center text-white shadow-md">
         <h2 class="text-xl font-bold">üöë Selamat Datang üöë</h2>
      <p id="quote-display" class="text-sm italic my-2">"..."</p>
         <p class="text-xs opacity-80">Emergency Room Team</p>
      </div>

      <div class="space-y-6 mb-8 border-b pb-6">
          <h2 class="text-xl font-semibold text-sky-600">Data Umum</h2>
          <div class="input-group">
            <label for="inputDate">Hari & Tanggal</label>
            <input
              type="text"
              id="inputDate"
              value=""
              placeholder="Senin, 01 Januari 2025"
            />
            <div class="input-group mt-4">
              <label for="inputCity">Kota</label>
              <input
                type="text"
                id="inputCity"
                value="Mojokerto"
                readonly
                class="bg-gray-100 cursor-default"
              />
            </div>
          </div>
      </div>

      <div id="shifts-container" class="space-y-6">
        <div class="shift-block" data-shift="Pagi1">
          <div
            class="shift-header cursor-pointer bg-gradient-to-r from-slate-600 to-slate-300"
            id="headerPagi1"
          >
            <span role="img" aria-label="emoji" class="mr-3 text-xl"></span>Shift Dini Hari (00.00 - 07.00)
          </div>
          <div
            class="p-4 bg-slate-50 rounded-b-xl space-y-4 hidden"
            id="contentPagi1"
          >
            <div class="space-y-4">
              <div class="input-group">
                <label for="drPagi1">Nama Dokter</label>
                <div class="doctor-inputs">
                  <select id="drPagi1">
                    <option value="">-- Pilih Dokter --</option>
                    <option value="dr. Sukresno Tjahjo W., M.Kes">dr. Sukresno Tjahjo W., M.Kes</option>
                    <option value="dr. Felicia Putri Hartono">dr. Felicia Putri Hartono</option>
                    <option value="dr. Syntia Desy Arisandi">dr. Syntia Desy Arisandi</option>
                    <option value="dr. Imam Fadli">dr. Imam Fadli</option>
                    <option value="dr. Deo Sanjaya">dr. Deo Sanjaya</option>
                    <option value="dr. Evva Mardiyana">dr. Evva Mardiyana</option>
                    <option value="dr. Farah Shania">dr. Farah Shania</option>
                    <option value="dr. Ratna Dewi">dr. Ratna Dewi</option>
                  </select>
                  <input
                    type="text"
                    id="drExtraPagi1"
                    value=""
                    placeholder="(Pengganti)"
                    title="Nama dokter pengganti/tambahan (misal: Budi) akan ditambahkan dalam kurung()"
                  />
                </div>
              </div>
              <div class="grid grid-cols-2 gap-3">
                <div class="input-group">
                  <label>Jumlah Pasien</label>
                  <input
                    type="text"
                    disabled
                    id="displayJmlPagi1"
                    value="0"
                    class="bg-gray-200"
                  />
                </div>
                <div class="input-group">
                  <label>Rawat Inap (MRS)</label>
                  <input
                    type="text"
                    disabled
                    id="displayMrsPagi1"
                    value="0"
                    class="bg-gray-200"
                  />
                </div>
              </div>
            </div>
            <h3 class="text-base font-semibold pt-2 text-sky-700 border-t pt-3">
              Rincian Kedatangan Pasien
            </h3>
            <div
              class="grid grid-cols-2 gap-3 p-3 bg-white rounded-lg border border-sky-200"
            >
              <div class="col-span-2 text-sm font-medium text-gray-600">
                Rujukan Puskesmas:
              </div>
              <div class="input-group">
                <label>Rawat Inap (RI)</label
                ><input type="number" id="pkmRIPagi1" value="0" min="0" />
              </div>
              <div class="input-group">
                <label>Rawat Jalan (RJ)</label
                ><input type="number" id="pkmRJPagi1" value="0" min="0" />
              </div>

              <div class="col-span-2 text-sm font-medium text-gray-600">
                Bawa Surat Rujukan:
              </div>
              <div class="input-group">
                <label>Rawat Inap (RI)</label
                ><input type="number" id="rujukRIPagi1" value="0" min="0" />
              </div>
              <div class="input-group">
                <label>Rawat Jalan (RJ)</label
                ><input type="number" id="rujukRJPagi1" value="0" min="0" />
              </div>

              <div class="col-span-2 text-sm font-medium text-gray-600">
                Bawa Hasil Lab:
              </div>
              <div class="input-group">
                <label>Rawat Inap (RI)</label
                ><input type="number" id="labRIPagi1" value="0" min="0" />
              </div>
              <div class="input-group">
                <label>Rawat Jalan (RJ)</label
                ><input type="number" id="labRJPagi1" value="0" min="0" />
              </div>

              <div class="col-span-2 text-sm font-medium text-gray-600">
                Diantar Siaga Desa:
              </div>
              <div class="input-group">
                <label>Rawat Inap (RI)</label
                ><input type="number" id="desaRIPagi1" value="0" min="0" />
              </div>
              <div class="input-group">
                <label>Rawat Jalan (RJ)</label
                ><input type="number" id="desaRJPagi1" value="0" min="0" />
              </div>

              <div class="col-span-2 text-sm font-medium text-gray-600">
                Datang Sendiri:
              </div>
              <div class="input-group">
                <label>Rawat Inap (RI)</label
                ><input type="number" id="sendiriRIPagi1" value="0" min="0" />
              </div>
              <div class="input-group">
                <label>Rawat Jalan (RJ)</label
                ><input type="number" id="sendiriRJPagi1" value="0" min="0" />
              </div>
            </div>

            <h3
              class="text-base font-semibold pt-2 text-gray-700 border-t pt-3"
            >
              Rincian Pembayaran
            </h3>
            <div class="input-row">
              <div class="input-group">
                <label>BPJS</label
                ><input type="number" id="bpjsPagi1" value="0" min="0" />
              </div>
              <div class="input-group">
                <label>Umum</label
                ><input type="number" id="umumPagi1" value="0" min="0" />
              </div>
            </div>

            <div class="input-group">
              <label>Rincian Keterangan BPJS</label>
              <textarea
                id="bpjsKetPagi1"
                rows="3"
                placeholder="Contoh:&#10;1. Tn X abc"
              ></textarea>
            </div>
            <div class="input-group">
              <label>Rincian Keterangan UMUM</label>
              <textarea
                id="umumKetPagi1"
                rows="3"
                placeholder="Contoh:&#10;1. Tn X abc"
              ></textarea>
            </div>

            <h3
              class="text-base font-semibold pt-2 text-gray-700 border-t pt-3"
            >
              Rincian Status Akhir
            </h3>
            <div class="input-group">
              <label>Rincian Keterangan DOA</label>
              <textarea
                id="doaKetPagi1"
                rows="2"
                placeholder="Contoh:&#10;1. Tn X DOA"
              ></textarea>
            </div>
            <div class="input-group">
              <label>Rincian Keterangan Meninggal</label>
              <textarea
                id="meninggalKetPagi1"
                rows="2"
                placeholder="Contoh:&#10;1. Tn X meninggal"
              ></textarea>
            </div>
            <div class="input-group">
              <label>Rincian Keterangan MCU</label>
              <textarea
                id="mcuKetPagi1"
                rows="2"
                placeholder="Contoh:&#10;1. Tn X MCU surat sehat"
              ></textarea>
            </div>
            <div class="input-group">
              <label>Rujukan dari Puskesmas</label>
              <textarea
                id="pkmRujukKetPagi1"
                rows="2"
                placeholder="Contoh:&#10;1. An Y rujukan PKM Dsn A"
              ></textarea>
            </div>
            <div class="input-group">
              <label>Rujuk ke Rumah Sakit Lain</label>
              <textarea
                id="rsLainKetPagi1"
                rows="2"
                placeholder="Contoh:&#10;1. Ny Z rujukan ke RS A"
              ></textarea>
            </div>
          </div>
        </div>

        <!-- Shift Pagi 2 (Diulang sesuai pola) -->
        <div class="shift-block" data-shift="Pagi2">
          <div
            class="shift-header cursor-pointer bg-gradient-to-r from-indigo-600 to-indigo-300"
            id="headerPagi2"
          >
            <span role="img" aria-label="emoji" class="mr-3 text-xl"></span>Shift Pagi (07.00 - 14.00)
          </div>
          <div
            class="p-4 bg-indigo-50 rounded-b-xl space-y-4 hidden"
            id="contentPagi2"
          >
            <!-- Konten Pagi 2 (sama dengan pola sebelumnya) -->
            <div class="space-y-4">
              <div class="input-group">
                <label for="drPagi2">Nama Dokter</label>
                <div class="doctor-inputs">
                  <select id="drPagi2">
                    <option value="">-- Pilih Dokter --</option>
                    <option value="dr. Sukresno Tjahjo W., M.Kes">dr. Sukresno Tjahjo W., M.Kes</option>
                    <option value="dr. Felicia Putri Hartono">dr. Felicia Putri Hartono</option>
                    <option value="dr. Syntia Desy Arisandi">dr. Syntia Desy Arisandi</option>
                    <option value="dr. Imam Fadli">dr. Imam Fadli</option>
                    <option value="dr. Deo Sanjaya">dr. Deo Sanjaya</option>
                    <option value="dr. Evva Mardiyana">dr. Evva Mardiyana</option>
                    <option value="dr. Farah Shania">dr. Farah Shania</option>
                    <option value="dr. Ratna Dewi">dr. Ratna Dewi</option>
                  </select>
                  <input type="text" id="drExtraPagi2" value="" placeholder="(Pengganti)" />
                </div>
              </div>
              <div class="grid grid-cols-2 gap-3">
                <div class="input-group"><label>Jumlah Pasien</label><input type="text" disabled id="displayJmlPagi2" value="0" class="bg-gray-200" /></div>
                <div class="input-group"><label>Rawat Inap (MRS)</label><input type="text" disabled id="displayMrsPagi2" value="0" class="bg-gray-200" /></div>
              </div>
            </div>
            <!-- ... sisa field input sama ... -->
            <h3 class="text-base font-semibold pt-2 text-sky-700 border-t pt-3">Rincian Kedatangan Pasien</h3>
            <div class="grid grid-cols-2 gap-3 p-3 bg-white rounded-lg border border-sky-200">
                <div class="col-span-2 text-sm font-medium text-gray-600">Rujukan Puskesmas:</div>
                <div class="input-group"><label>Rawat Inap (RI)</label><input type="number" id="pkmRIPagi2" value="0" min="0" /></div>
                <div class="input-group"><label>Rawat Jalan (RJ)</label><input type="number" id="pkmRJPagi2" value="0" min="0" /></div>
                <div class="col-span-2 text-sm font-medium text-gray-600">Bawa Surat Rujukan:</div>
                <div class="input-group"><label>Rawat Inap (RI)</label><input type="number" id="rujukRIPagi2" value="0" min="0" /></div>
                <div class="input-group"><label>Rawat Jalan (RJ)</label><input type="number" id="rujukRJPagi2" value="0" min="0" /></div>
                <div class="col-span-2 text-sm font-medium text-gray-600">Bawa Hasil Lab:</div>
                <div class="input-group"><label>Rawat Inap (RI)</label><input type="number" id="labRIPagi2" value="0" min="0" /></div>
                <div class="input-group"><label>Rawat Jalan (RJ)</label><input type="number" id="labRJPagi2" value="0" min="0" /></div>
                <div class="col-span-2 text-sm font-medium text-gray-600">Diantar Siaga Desa:</div>
                <div class="input-group"><label>Rawat Inap (RI)</label><input type="number" id="desaRIPagi2" value="0" min="0" /></div>
                <div class="input-group"><label>Rawat Jalan (RJ)</label><input type="number" id="desaRJPagi2" value="0" min="0" /></div>
                <div class="col-span-2 text-sm font-medium text-gray-600">Datang Sendiri:</div>
                <div class="input-group"><label>Rawat Inap (RI)</label><input type="number" id="sendiriRIPagi2" value="0" min="0" /></div>
                <div class="input-group"><label>Rawat Jalan (RJ)</label><input type="number" id="sendiriRJPagi2" value="0" min="0" /></div>
            </div>
            <h3 class="text-base font-semibold pt-2 text-gray-700 border-t pt-3">Rincian Pembayaran</h3>
            <div class="input-row">
              <div class="input-group"><label>BPJS</label><input type="number" id="bpjsPagi2" value="0" min="0" /></div>
              <div class="input-group"><label>Umum</label><input type="number" id="umumPagi2" value="0" min="0" /></div>
            </div>
            <div class="input-group"><label>Rincian Keterangan BPJS</label><textarea id="bpjsKetPagi2" rows="3"></textarea></div>
            <div class="input-group"><label>Rincian Keterangan UMUM</label><textarea id="umumKetPagi2" rows="3"></textarea></div>
            <h3 class="text-base font-semibold pt-2 text-gray-700 border-t pt-3">Rincian Status Akhir</h3>
            <div class="input-group"><label>Rincian Keterangan DOA</label><textarea id="doaKetPagi2" rows="2"></textarea></div>
            <div class="input-group"><label>Rincian Keterangan Meninggal</label><textarea id="meninggalKetPagi2" rows="2"></textarea></div>
            <div class="input-group"><label>Rincian Keterangan MCU</label><textarea id="mcuKetPagi2" rows="2"></textarea></div>
            <div class="input-group"><label>Rujukan dari Puskesmas</label><textarea id="pkmRujukKetPagi2" rows="2"></textarea></div>
            <div class="input-group"><label>Rujuk ke Rumah Sakit Lain</label><textarea id="rsLainKetPagi2" rows="2"></textarea></div>
          </div>
        </div>

        <!-- Shift Siang -->
        <div class="shift-block" data-shift="Siang">
          <div
            class="shift-header cursor-pointer bg-gradient-to-r from-amber-600 to-amber-300"
            id="headerSiang"
          >
            <span role="img" aria-label="emoji" class="mr-3 text-xl"></span>Shift Siang (14.00 - 21.00)
          </div>
          <div class="p-4 bg-amber-50 rounded-b-xl space-y-4 hidden" id="contentSiang">
            <!-- Konten Siang -->
            <div class="space-y-4">
              <div class="input-group">
                <label for="drSiang">Nama Dokter</label>
                <div class="doctor-inputs">
                  <select id="drSiang">
                    <option value="">-- Pilih Dokter --</option>
                    <option value="dr. Sukresno Tjahjo W., M.Kes">dr. Sukresno Tjahjo W., M.Kes</option>
                    <option value="dr. Felicia Putri Hartono">dr. Felicia Putri Hartono</option>
                    <option value="dr. Syntia Desy Arisandi">dr. Syntia Desy Arisandi</option>
                    <option value="dr. Imam Fadli">dr. Imam Fadli</option>
                    <option value="dr. Deo Sanjaya">dr. Deo Sanjaya</option>
                    <option value="dr. Evva Mardiyana">dr. Evva Mardiyana</option>
                    <option value="dr. Farah Shania">dr. Farah Shania</option>
                    <option value="dr. Ratna Dewi">dr. Ratna Dewi</option>
                  </select>
                  <input type="text" id="drExtraSiang" value="" placeholder="(Pengganti)" />
                </div>
              </div>
              <div class="grid grid-cols-2 gap-3">
                <div class="input-group"><label>Jumlah Pasien</label><input type="text" disabled id="displayJmlSiang" value="0" class="bg-gray-200" /></div>
                <div class="input-group"><label>Rawat Inap (MRS)</label><input type="text" disabled id="displayMrsSiang" value="0" class="bg-gray-200" /></div>
              </div>
            </div>
            <!-- ... sisa field input ... -->
            <h3 class="text-base font-semibold pt-2 text-sky-700 border-t pt-3">Rincian Kedatangan Pasien</h3>
            <div class="grid grid-cols-2 gap-3 p-3 bg-white rounded-lg border border-sky-200">
                <div class="col-span-2 text-sm font-medium text-gray-600">Rujukan Puskesmas:</div>
                <div class="input-group"><label>Rawat Inap (RI)</label><input type="number" id="pkmRISiang" value="0" min="0" /></div>
                <div class="input-group"><label>Rawat Jalan (RJ)</label><input type="number" id="pkmRJSiang" value="0" min="0" /></div>
                <div class="col-span-2 text-sm font-medium text-gray-600">Bawa Surat Rujukan:</div>
                <div class="input-group"><label>Rawat Inap (RI)</label><input type="number" id="rujukRISiang" value="0" min="0" /></div>
                <div class="input-group"><label>Rawat Jalan (RJ)</label><input type="number" id="rujukRJSiang" value="0" min="0" /></div>
                <div class="col-span-2 text-sm font-medium text-gray-600">Bawa Hasil Lab:</div>
                <div class="input-group"><label>Rawat Inap (RI)</label><input type="number" id="labRISiang" value="0" min="0" /></div>
                <div class="input-group"><label>Rawat Jalan (RJ)</label><input type="number" id="labRJSiang" value="0" min="0" /></div>
                <div class="col-span-2 text-sm font-medium text-gray-600">Diantar Siaga Desa:</div>
                <div class="input-group"><label>Rawat Inap (RI)</label><input type="number" id="desaRISiang" value="0" min="0" /></div>
                <div class="input-group"><label>Rawat Jalan (RJ)</label><input type="number" id="desaRJSiang" value="0" min="0" /></div>
                <div class="col-span-2 text-sm font-medium text-gray-600">Datang Sendiri:</div>
                <div class="input-group"><label>Rawat Inap (RI)</label><input type="number" id="sendiriRISiang" value="0" min="0" /></div>
                <div class="input-group"><label>Rawat Jalan (RJ)</label><input type="number" id="sendiriRJSiang" value="0" min="0" /></div>
            </div>
            <h3 class="text-base font-semibold pt-2 text-gray-700 border-t pt-3">Rincian Pembayaran</h3>
            <div class="input-row">
              <div class="input-group"><label>BPJS</label><input type="number" id="bpjsSiang" value="0" min="0" /></div>
              <div class="input-group"><label>Umum</label><input type="number" id="umumSiang" value="0" min="0" /></div>
            </div>
            <div class="input-group"><label>Rincian Keterangan BPJS</label><textarea id="bpjsKetSiang" rows="3"></textarea></div>
            <div class="input-group"><label>Rincian Keterangan UMUM</label><textarea id="umumKetSiang" rows="3"></textarea></div>
            <h3 class="text-base font-semibold pt-2 text-gray-700 border-t pt-3">Rincian Status Akhir</h3>
            <div class="input-group"><label>Rincian Keterangan DOA</label><textarea id="doaKetSiang" rows="2"></textarea></div>
            <div class="input-group"><label>Rincian Keterangan Meninggal</label><textarea id="meninggalKetSiang" rows="2"></textarea></div>
            <div class="input-group"><label>Rincian Keterangan MCU</label><textarea id="mcuKetSiang" rows="2"></textarea></div>
            <div class="input-group"><label>Rujukan dari Puskesmas</label><textarea id="pkmRujukKetSiang" rows="2"></textarea></div>
            <div class="input-group"><label>Rujuk ke Rumah Sakit Lain</label><textarea id="rsLainKetSiang" rows="2"></textarea></div>
          </div>
        </div>

        <!-- Shift Malam -->
        <div class="shift-block" data-shift="Malam">
          <div
            class="shift-header cursor-pointer bg-gradient-to-r from-fuchsia-600 to-fuchsia-300"
            id="headerMalam"
          >
            <span role="img" aria-label="emoji" class="mr-3 text-xl"></span>Shift Malam (21.00 - 00.00)
          </div>
          <div class="p-4 bg-fuchsia-50 rounded-b-xl space-y-4 hidden" id="contentMalam">
            <div class="space-y-4">
              <div class="input-group">
                <label for="drMalam">Nama Dokter</label>
                <div class="doctor-inputs">
                  <select id="drMalam">
                    <option value="">-- Pilih Dokter --</option>
                    <option value="dr. Sukresno Tjahjo W., M.Kes">dr. Sukresno Tjahjo W., M.Kes</option>
                    <option value="dr. Felicia Putri Hartono">dr. Felicia Putri Hartono</option>
                    <option value="dr. Syntia Desy Arisandi">dr. Syntia Desy Arisandi</option>
                    <option value="dr. Imam Fadli">dr. Imam Fadli</option>
                    <option value="dr. Deo Sanjaya">dr. Deo Sanjaya</option>
                    <option value="dr. Evva Mardiyana">dr. Evva Mardiyana</option>
                    <option value="dr. Farah Shania">dr. Farah Shania</option>
                    <option value="dr. Ratna Dewi">dr. Ratna Dewi</option>
                  </select>
                  <input type="text" id="drExtraMalam" value="" placeholder="(Pengganti)" />
                </div>
              </div>
              <div class="grid grid-cols-2 gap-3">
                <div class="input-group"><label>Jumlah Pasien</label><input type="text" disabled id="displayJmlMalam" value="0" class="bg-gray-200" /></div>
                <div class="input-group"><label>Rawat Inap (MRS)</label><input type="text" disabled id="displayMrsMalam" value="0" class="bg-gray-200" /></div>
              </div>
            </div>
            <h3 class="text-base font-semibold pt-2 text-sky-700 border-t pt-3">Rincian Kedatangan Pasien</h3>
            <div class="grid grid-cols-2 gap-3 p-3 bg-white rounded-lg border border-sky-200">
                <div class="col-span-2 text-sm font-medium text-gray-600">Rujukan Puskesmas:</div>
                <div class="input-group"><label>Rawat Inap (RI)</label><input type="number" id="pkmRIMalam" value="0" min="0" /></div>
                <div class="input-group"><label>Rawat Jalan (RJ)</label><input type="number" id="pkmRJMalam" value="0" min="0" /></div>
                <div class="col-span-2 text-sm font-medium text-gray-600">Bawa Surat Rujukan:</div>
                <div class="input-group"><label>Rawat Inap (RI)</label><input type="number" id="rujukRIMalam" value="0" min="0" /></div>
                <div class="input-group"><label>Rawat Jalan (RJ)</label><input type="number" id="rujukRJMalam" value="0" min="0" /></div>
                <div class="col-span-2 text-sm font-medium text-gray-600">Bawa Hasil Lab:</div>
                <div class="input-group"><label>Rawat Inap (RI)</label><input type="number" id="labRIMalam" value="0" min="0" /></div>
                <div class="input-group"><label>Rawat Jalan (RJ)</label><input type="number" id="labRJMalam" value="0" min="0" /></div>
                <div class="col-span-2 text-sm font-medium text-gray-600">Diantar Siaga Desa:</div>
                <div class="input-group"><label>Rawat Inap (RI)</label><input type="number" id="desaRIMalam" value="0" min="0" /></div>
                <div class="input-group"><label>Rawat Jalan (RJ)</label><input type="number" id="desaRJMalam" value="0" min="0" /></div>
                <div class="col-span-2 text-sm font-medium text-gray-600">Datang Sendiri:</div>
                <div class="input-group"><label>Rawat Inap (RI)</label><input type="number" id="sendiriRIMalam" value="0" min="0" /></div>
                <div class="input-group"><label>Rawat Jalan (RJ)</label><input type="number" id="sendiriRJMalam" value="0" min="0" /></div>
            </div>
            <h3 class="text-base font-semibold pt-2 text-gray-700 border-t pt-3">Rincian Pembayaran</h3>
            <div class="input-row">
              <div class="input-group"><label>BPJS</label><input type="number" id="bpjsMalam" value="0" min="0" /></div>
              <div class="input-group"><label>Umum</label><input type="number" id="umumMalam" value="0" min="0" /></div>
            </div>
            <div class="input-group"><label>Rincian Keterangan BPJS</label><textarea id="bpjsKetMalam" rows="3"></textarea></div>
            <div class="input-group"><label>Rincian Keterangan UMUM</label><textarea id="umumKetMalam" rows="3"></textarea></div>
            <h3 class="text-base font-semibold pt-2 text-gray-700 border-t pt-3">Rincian Status Akhir</h3>
            <div class="input-group"><label>Rincian Keterangan DOA</label><textarea id="doaKetMalam" rows="2"></textarea></div>
            <div class="input-group"><label>Rincian Keterangan Meninggal</label><textarea id="meninggalKetMalam" rows="2"></textarea></div>
            <div class="input-group"><label>Rincian Keterangan MCU</label><textarea id="mcuKetMalam" rows="2"></textarea></div>
            <div class="input-group"><label>Rujukan dari Puskesmas</label><textarea id="pkmRujukKetMalam" rows="2"></textarea></div>
            <div class="input-group"><label>Rujuk ke Rumah Sakit Lain</label><textarea id="rsLainKetMalam" rows="2"></textarea></div>
          </div>
        </div>
      </div>

      <div class="mt-8">
        <h2 class="text-xl font-semibold text-gray-800 mb-2">
          Hasil Laporan Siap Salin
        </h2>
        <textarea
          id="outputReport"
          class="w-full h-64 bg-gray-100 text-gray-800 p-4 border border-gray-300 rounded-xl font-mono text-sm resize-none"
          readonly
          placeholder="Laporan yang sudah terformat akan muncul di sini..."
          style="white-space: pre;"
        ></textarea>

        <!-- BAGIAN WARNING MESSAGE YANG DIPERBAIKI -->
        <div
          id="doctorWarningMessage"
          class="mt-3 p-4 bg-red-100 border border-red-400 text-red-700 rounded-xl font-medium hidden"
        >
          <div class="flex items-center gap-2 mb-2">
            <span class="text-2xl">‚ö†Ô∏è</span>
            <span class="text-lg font-bold">Lengkapi Nama Dokter</span>
          </div>
          <p class="text-sm mb-1 opacity-90">Mohon isi nama dokter jaga atau nama pengganti untuk shift berikut agar laporan dapat disalin:</p>
          <ul id="missingDoctorsList" class="list-disc list-inside text-sm font-bold bg-white/40 p-2 rounded-lg"></ul>
        </div>

        <button
          id="copyBtn"
          class="w-full bg-emerald-500 hover:bg-emerald-600 text-white font-bold py-3 px-4 rounded-xl mt-3 transition duration-150 shadow-lg hover:shadow-xl disabled:opacity-50 disabled:cursor-not-allowed"
          disabled
        >
          <span role="img" aria-label="emoji" class="mr-1">üìã</span> Salin
          Laporan ke Clipboard
        </button>

        <button
          id="resetBtn"
          class="w-full bg-red-600 hover:bg-red-700 text-white font-bold py-3 px-4 rounded-xl mt-8 transition duration-150 shadow-md hover:shadow-lg"
        >
          <span role="img" aria-label="emoji" class="mr-1">üóëÔ∏è</span> Hapus Semua
          Data
        </button>
        <div
          id="copyMessage"
          class="mt-2 text-sm text-center font-medium hidden"
        >
          Berhasil disalin!
        </div>
      </div>

      <div class="mt-6 pt-4 border-t border-gray-200">
        <h3 class="text-lg font-semibold text-gray-800 mb-3 text-center">
          Tautan Cepat
        </h3>
        <div class="flex flex-col md:flex-row gap-3">
          <button id="navBtn1" class="flex-1 bg-sky-600 hover:bg-sky-700 text-white font-bold py-3 px-4 rounded-xl transition shadow-md">üíª Lap. Bulanan</button>
          <button id="navBtn2" class="flex-1 bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-3 px-4 rounded-xl transition shadow-md">üìë Kalkulator</button>
          <button id="navBtn3" class="flex-1 bg-purple-600 hover:bg-purple-700 text-white font-bold py-3 px-4 rounded-xl transition shadow-md">üîó GDrive</button>
        </div>
      </div>

      <div class="mt-8 border-t pt-6">
        <div id="changelogHeader" class="flex justify-between items-center cursor-pointer mb-2">
          <h2 class="text-xl font-semibold text-gray-800">Changelog Aplikasi</h2>
          <svg id="changelogIcon" class="w-5 h-5 text-gray-500 transform transition-transform duration-300" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
          </svg>
        </div>
        <div id="changelogContent" class="hidden">
            <ul class="list-disc list-inside text-gray-600 space-y-4 pl-4 text-sm">
                <li><span class="font-semibold">Update [02 Jan 2026]</span>: Penyempurnaan UI/UX Warning Dokter.</li>
                <li><span class="font-semibold">Update [31 Des 2025]</span>: Fitur auto update GitHub.</li>
            </ul>
        </div>
      </div>
    </div>

    <script>
      /* ========================================================
         LOGIKA PEMBARUAN OTOMATIS GITHUB
         ======================================================== */
      const GITHUB_CONFIG = {
          repo: "igdrsdh/Aplikasi-Laporan-Harian",
          branch: "main",
          checkInterval: 300000 
      };

      async function checkGitHubUpdate() {
          try {
              const response = await fetch(`https://api.github.com/repos/${GITHUB_CONFIG.repo}/commits/${GITHUB_CONFIG.branch}`);
              if (!response.ok) return;
              const data = await response.json();
              const latestSha = data.sha;
              const localSha = localStorage.getItem('last_github_commit');
              if (localSha && localSha !== latestSha) {
                  localStorage.setItem('last_github_commit', latestSha);
                  if (confirm("Pembaruan aplikasi versi terbaru tersedia. Klik OK untuk memperbarui.")) {
                      window.location.reload(true);
                  }
              } else {
                  localStorage.setItem('last_github_commit', latestSha);
              }
          } catch (error) { console.error("Gagal memeriksa update GitHub:", error); }
      }

      const allShiftNames = ['Pagi1', 'Pagi2', 'Siang', 'Malam'];
      const allContentIds = allShiftNames.map(name => `content${name}`);

      function getNum(id) { const val = document.getElementById(id).value; return Number(val) || 0; }
      function getStr(id) { const element = document.getElementById(id); return element ? element.value.trim() : ''; }

      function getDoctorName(shift) {
          const drName = document.getElementById(`dr${shift}`).value.trim();
          const drExtra = document.getElementById(`drExtra${shift}`).value.trim();
          if (drName) return drExtra ? `${drName} (${drExtra})` : drName;
          return drExtra || '';
      }

      function isDoctorFilled(shift) {
          return document.getElementById(`dr${shift}`).value.trim() !== '' || 
                 document.getElementById(`drExtra${shift}`).value.trim() !== '';
      }

      function formatRincianStatusAkhir(text) { return text ? `\n${text}` : ''; }

      function showNotification(message, colorClass = 'text-green-700') {
          const copyMessage = document.getElementById('copyMessage');
          copyMessage.textContent = message;
          copyMessage.className = `mt-2 text-sm text-center font-medium ${colorClass}`;
          copyMessage.classList.remove('hidden');
          setTimeout(() => copyMessage.classList.add('hidden'), 3000);
      }

      function saveData() {
          const dataToSave = { inputCity: getStr('inputCity'), inputDate: getStr('inputDate') };
          const shifts = ['Pagi1', 'Pagi2', 'Siang', 'Malam'];
          const fields = ['dr', 'drExtra', 'bpjsKet', 'umumKet', 'doaKet', 'meninggalKet', 'mcuKet', 'pkmRujukKet', 'rsLainKet', 'pkmRI', 'pkmRJ', 'rujukRI', 'rujukRJ', 'labRI', 'labRJ', 'desaRI', 'desaRJ', 'sendiriRI', 'sendiriRJ', 'bpjs', 'umum'];
          shifts.forEach(s => fields.forEach(f => {
              const id = `${f}${s}`;
              const el = document.getElementById(id);
              if (el) dataToSave[id] = el.value;
          }));
          localStorage.setItem('igdReportData', JSON.stringify(dataToSave));
      }

      function loadData() {
          const savedData = localStorage.getItem('igdReportData');
          if (!savedData) return;
          try {
              const data = JSON.parse(savedData);
              for (const id in data) {
                  const el = document.getElementById(id);
                  if (el && id !== 'inputCity') el.value = data[id];
              }
          } catch (e) { localStorage.removeItem('igdReportData'); }
      }

      function generateReport() {
          const city = getStr('inputCity');
          const dateStr = getStr('inputDate');
          const shifts = ['Pagi1', 'Pagi2', 'Siang', 'Malam'];
          const shiftData = {};
          const missingDoctors = [];
          let totalK = 0, totalM = 0;
          let breakdown = { Pagi1: [0,0], Pagi2: [0,0], Siang: [0,0], Malam: [0,0] };

          shifts.forEach(shift => {
              if (!isDoctorFilled(shift)) {
                  const headerText = document.getElementById(`header${shift}`).innerText.trim();
                  missingDoctors.push(headerText);
              }

              const counts = ['pkmRI', 'pkmRJ', 'rujukRI', 'rujukRJ', 'labRI', 'labRJ', 'desaRI', 'desaRJ', 'sendiriRI', 'sendiriRJ'].map(k => getNum(`${k}${shift}`));
              const shiftMRS = counts[0] + counts[2] + counts[4] + counts[6] + counts[8];
              const shiftRJ = counts[1] + counts[3] + counts[5] + counts[7] + counts[9];
              const shiftJml = shiftMRS + shiftRJ;

              document.getElementById(`displayJml${shift}`).value = shiftJml;
              document.getElementById(`displayMrs${shift}`).value = shiftMRS;

              shiftData[shift] = {
                  dr: getDoctorName(shift), jml: shiftJml, mrs: shiftMRS, rj: shiftRJ,
                  bpjs: getNum(`bpjs${shift}`), umum: getNum(`umum${shift}`),
                  bpjsKet: getStr(`bpjsKet${shift}`), umumKet: getStr(`umumKet${shift}`),
                  doaKet: formatRincianStatusAkhir(getStr(`doaKet${shift}`)),
                  meninggalKet: formatRincianStatusAkhir(getStr(`meninggalKet${shift}`)),
                  mcuKet: formatRincianStatusAkhir(getStr(`mcuKet${shift}`)),
                  pkmRujukKet: formatRincianStatusAkhir(getStr(`pkmRujukKet${shift}`)),
                  rsLainKet: formatRincianStatusAkhir(getStr(`rsLainKet${shift}`)),
                  pkmRI: counts[0], pkmRJ: counts[1], rujukRI: counts[2], rujukRJ: counts[3], labRI: counts[4], labRJ: counts[5], desaRI: counts[6], desaRJ: counts[7], sendiriRI: counts[8], sendiriRJ: counts[9]
              };
              totalK += shiftJml; totalM += shiftMRS;
              breakdown[shift] = [shiftJml, shiftMRS];
          });

          // LOGIKA PENYAJIAN WARNING DOKTER YANG DIPERBAIKI
          const warnBox = document.getElementById('doctorWarningMessage');
          const warnList = document.getElementById('missingDoctorsList');
          const copyBtn = document.getElementById('copyBtn');

          if (missingDoctors.length > 0) {
              warnList.innerHTML = missingDoctors.map(d => `<li>${d}</li>`).join('');
              warnBox.classList.remove('hidden');
              copyBtn.disabled = true;
          } else {
              warnBox.classList.add('hidden');
              copyBtn.disabled = false;
          }

          let report = `LAPORAN JAGA IGD\n\n${city}, ${dateStr} Jam 00.00\n\n`;
          report += `TOTAL KUNJUNGAN IGD ${totalK} PASIEN\nDINI HARI : ${breakdown.Pagi1[0]} px, MRS: ${breakdown.Pagi1[1]}\nPAGI      : ${breakdown.Pagi2[0]} px, MRS: ${breakdown.Pagi2[1]}\nSIANG     : ${breakdown.Siang[0]} px, MRS: ${breakdown.Siang[1]}\nMALAM     : ${breakdown.Malam[0]} px, MRS: ${breakdown.Malam[1]}\n\n`;

          const labels = { Pagi1: ['Shift Dini Hari', '00.00 - 07.00'], Pagi2: ['Shift Pagi', '07.00 - 14.00'], Siang: ['Shift Siang', '14.00 - 21.00'], Malam: ['Shift Malam', '21.00 - 00.00'] };
          
          shifts.forEach(s => {
              const d = shiftData[s];
              report += `${labels[s][0]}\nJam ${labels[s][1]} Wib\nDokter jaga : ${d.dr || '-'}\nTotal kunjungan : ${d.jml || '-'}\nTotal rawat inap : ${d.mrs || '-'}\n\nKeterangan :\nPasien BPJS : ${d.bpjs || '-'}\nPasien Umum : ${d.umum || '-'}\nPasien Rawat jalan : ${d.rj || '-'}\n\nRincian jumlah pasien yang datang:\n-Rujukan Puskesmas:\n\u2022 Rawat inap : ${d.pkmRI || '-'}\n\u2022 Rawat jalan : ${d.pkmRJ || '-'}\n-Bawa surat rujukan :\n\u2022 Rawat inap : ${d.rujukRI || '-'}\n\u2022 Rawat jalan : ${d.rujukRJ || '-'}\n-Bawa hasil lab : \n\u2022 Rawat inap : ${d.labRI || '-'}\n\u2022 Rawat jalan : ${d.labRJ || '-'}\n-Diantar siaga desa : \n\u2022 Rawat inap : ${d.desaRI || '-'}\n\u2022 Rawat jalan : ${d.desaRJ || '-'}\n-Datang sendiri : \n\u2022 Rawat inap : ${d.sendiriRI || '-'}\n\u2022 Rawat jalan : ${d.sendiriRJ || '-'}\n\nRINCIAN KASUS RAWAT JALAN\nBPJS:\n${d.bpjsKet || '- Tidak ada'}\n\nUMUM:\n${d.umumKet || '- Tidak ada'}\n\nRINCIAN STATUS AKHIR\nDOA (Death On Arrival) :${d.doaKet || '-'}\nMeninggal di IGD :${d.meninggalKet || '-'}\nMCU (Medical Check Up) :${d.mcuKet || '-'}\nRujukan dari Puskesmas :${d.pkmRujukKet || '-'}\nRujuk ke Rumah Sakit Lain :${d.rsLainKet || '-'}\nCovid Rawat Jalan: -\n\n`;
          });
          document.getElementById('outputReport').value = report;
      }

      function copyReport() {
          const output = document.getElementById('outputReport');
          output.select();
          document.execCommand('copy');
          showNotification('Berhasil disalin!');
      }

      function resetAllInputs() {
          if (!confirm("Hapus semua data?")) return;
          document.querySelectorAll('input:not(#inputCity), textarea, select').forEach(i => {
              if (i.type === 'number') i.value = '0';
              else i.value = '';
          });
          localStorage.removeItem('igdReportData');
          generateReport();
      }

      const quotes = ["Semangat shift ini, rejeki takkan tertukar.", "Lelah hari ini adalah investasi masa depan.", "Apapun shiftnya, kopi kuncinya.", "Satu shift lagi menuju liburan!", "Triage tepat, kerja cepat.", "Senyummu adalah obat pertama.", "Sudah dimakan bekalnya?ü§≠"];
      function shuffleQuote() { document.getElementById('quote-display').innerText = `"${quotes[Math.floor(Math.random()*quotes.length)]}"`; }

      window.onload = function() {
          if (localStorage.getItem("darkMode") === "enabled") document.documentElement.classList.add("dark");
          document.getElementById('darkToggle').onclick = () => {
              const isDark = document.documentElement.classList.toggle("dark");
              localStorage.setItem("darkMode", isDark ? "enabled" : "disabled");
          };
          
          loadData();
          shuffleQuote();
          setInterval(shuffleQuote, 60000);
          checkGitHubUpdate();
          setInterval(checkGitHubUpdate, GITHUB_CONFIG.checkInterval);

          document.querySelectorAll('input, textarea, select').forEach(i => {
              i.oninput = () => { generateReport(); saveData(); };
              i.onchange = () => { generateReport(); saveData(); };
          });

          allShiftNames.forEach(s => {
              document.getElementById(`header${s}`).onclick = () => {
                  const content = document.getElementById(`content${s}`);
                  const isHidden = content.classList.contains('hidden');
                  allContentIds.forEach(id => document.getElementById(id).classList.add('hidden'));
                  if (isHidden) content.classList.remove('hidden');
              };
          });

          document.getElementById('changelogHeader').onclick = () => {
              document.getElementById('changelogContent').classList.toggle('hidden');
              document.getElementById('changelogIcon').classList.toggle('rotate-180');
          };

          document.getElementById('refreshBtn').onclick = () => { if(confirm("Segarkan halaman?")) window.location.reload(); };
          document.getElementById('copyBtn').onclick = copyReport;
          document.getElementById('resetBtn').onclick = resetAllInputs;
          document.getElementById('navBtn1').onclick = () => window.open('https://igdrsdh.github.io/Laporan-Bulanan/', '_blank');
          document.getElementById('navBtn2').onclick = () => window.open('https://igdrsdh.github.io/Multitool-IGD/', '_blank');
          document.getElementById('navBtn3').onclick = () => window.open('https://drive.google.com/drive/folders/1yKZu0DHZ0k084Q6p0FAW63Oc7Zy3e9ZF', '_blank');
          
          generateReport();
      };
    </script>
  </body>
</html>

